/*!
 * MockJax - jQuery Plugin to Mock Ajax requests
 *
 * Version:  1.6.1
 * Released:
 * Home:   https://github.com/jakerella/jquery-mockjax
 * Author:   Jonathan Sharp (http://jdsharp.com)
 * License:  MIT,GPL
 *
 * Copyright (c) 2014 appendTo, Jordan Kasper
 * NOTE: This repository was taken over by Jordan Kasper (@jakerella) October, 2014
 * 
 * Dual licensed under the MIT or GPL licenses.
 * http://opensource.org/licenses/MIT OR http://www.gnu.org/licenses/gpl-2.0.html
 */
(function(n){function a(t){var i,u,f;window.DOMParser==undefined&&window.ActiveXObject&&(DOMParser=function(){},DOMParser.prototype.parseFromString=function(n){var t=new ActiveXObject("Microsoft.XMLDOM");return t.async="false",t.loadXML(n),t});try{if(i=(new DOMParser).parseFromString(t,"text/xml"),n.isXMLDoc(i)){if(u=n("parsererror",i),u.length==1)throw new Error("Error: "+n(i).text());}else throw new Error("Unable to parse XML");return i}catch(r){return f=r.name==undefined?r:r.name+": "+r.message,n(document).trigger("xmlParseError",[f]),undefined}}function o(t,i){var r=!0;return typeof i=="string"?n.isFunction(t.test)?t.test(i):t==i:(n.each(t,function(u){if(i[u]===undefined)return r=!1;typeof i[u]=="object"&&i[u]!==null?(r&&n.isArray(i[u])&&(r=n.isArray(t[u])&&i[u].length===t[u].length),r=r&&o(t[u],i[u])):r=t[u]&&n.isFunction(t[u].test)?r&&t[u].test(i[u]):r&&t[u]==i[u]}),r)}function s(t,i){return t[i]===n.mockjaxSettings[i]}function v(t,i){if(n.isFunction(t))return t(i);if(n.isFunction(t.url.test)){if(!t.url.test(i.url))return null}else{var r=t.url.indexOf("*");if(t.url!==i.url&&r===-1||!new RegExp(t.url.replace(/[-[\]{}()+?.,\\^$|#\s]/g,"\\$&").replace(/\*/g,".+")).test(i.url))return null}return t.data&&(!i.data||!o(t.data,i.data))?null:t&&t.type&&t.type.toLowerCase()!=i.type.toLowerCase()?null:t}function e(t){if(n.isArray(t)){var i=t[0],r=t[1];return typeof i=="number"&&typeof r=="number"?Math.floor(Math.random()*(r-i))+i:null}return typeof t=="number"?t:null}function y(t,i,u){var f=function(r){return function(){return function(){this.status=t.status;this.statusText=t.statusText;this.readyState=1;var f=function(){this.readyState=4;var r;i.dataType=="json"&&typeof t.responseText=="object"?this.responseText=JSON.stringify(t.responseText):i.dataType=="xml"?typeof t.responseXML=="string"?(this.responseXML=a(t.responseXML),this.responseText=t.responseXML):this.responseXML=t.responseXML:typeof t.responseText=="object"&&t.responseText!==null?(t.contentType="application/json",this.responseText=JSON.stringify(t.responseText)):this.responseText=t.responseText;(typeof t.status=="number"||typeof t.status=="string")&&(this.status=t.status);typeof t.statusText=="string"&&(this.statusText=t.statusText);r=this.onreadystatechange||this.onload;n.isFunction(r)?(t.isTimeout&&(this.status=-1),r.call(this,t.isTimeout?"timeout":undefined)):t.isTimeout&&(this.status=-1)};if(n.isFunction(t.response)){if(t.response.length===2){t.response(u,function(){f.call(r)});return}t.response(u)}f.call(r)}.apply(r)}}(this);t.proxy?r({global:!1,url:t.proxy,type:t.proxyType,data:t.data,dataType:i.dataType==="script"?"text/plain":i.dataType,complete:function(n){t.responseXML=n.responseXML;t.responseText=n.responseText;s(t,"status")&&(t.status=n.status);s(t,"statusText")&&(t.statusText=n.statusText);this.responseTimer=setTimeout(f,e(t.responseTime)||0)}}):i.async===!1?f():this.responseTimer=setTimeout(f,e(t.responseTime)||50)}function p(t,i,r,u){return t=n.extend(!0,{},n.mockjaxSettings,t),typeof t.headers=="undefined"&&(t.headers={}),typeof i.headers=="undefined"&&(i.headers={}),t.contentType&&(t.headers["content-type"]=t.contentType),{status:t.status,statusText:t.statusText,readyState:1,open:function(){},send:function(){u.fired=!0;y.call(this,t,i,r)},abort:function(){clearTimeout(this.responseTimer)},setRequestHeader:function(n,t){i.headers[n]=t},getResponseHeader:function(n){return t.headers&&t.headers[n]?t.headers[n]:n.toLowerCase()=="last-modified"?t.lastModified||(new Date).toString():n.toLowerCase()=="etag"?t.etag||"":n.toLowerCase()=="content-type"?t.contentType||"text/plain":void 0},getAllResponseHeaders:function(){var i="";return t.contentType&&(t.headers["Content-Type"]=t.contentType),n.each(t.headers,function(n,t){i+=n+": "+t+"\n"}),i}}}function w(n,t,r){var f;if(b(n),n.dataType="json",n.data&&i.test(n.data)||i.test(n.url)){d(n,t,r);var u=/^(\w+:)?\/\/([^\/?#]+)/.exec(n.url),e=u&&(u[1]&&u[1]!==location.protocol||u[2]!==location.host);if(n.dataType="script",n.type.toUpperCase()==="GET"&&e)return f=k(n,t,r),f?f:!0}return null}function b(n){n.type.toUpperCase()==="GET"?i.test(n.url)||(n.url+=(/\?/.test(n.url)?"&":"?")+(n.jsonp||"callback")+"=?"):n.data&&i.test(n.data)||(n.data=(n.data?n.data+"&":"")+(n.jsonp||"callback")+"=?")}function k(t,i,r){var u=r&&r.context||t,f=null;return i.response&&n.isFunction(i.response)?i.response(r):typeof i.responseText=="object"?n.globalEval("("+JSON.stringify(i.responseText)+")"):n.globalEval("("+i.responseText+")"),setTimeout(function(){h(t,u,i);c(t,u,i)},e(i.responseTime)||0),n.Deferred&&(f=new n.Deferred,typeof i.responseText=="object"?f.resolveWith(u,[i.responseText]):f.resolveWith(u,[n.parseJSON(i.responseText)])),f}function d(n,t,r){var f=r&&r.context||n,u=n.jsonpCallback||"jsonp"+l++;n.data&&(n.data=(n.data+"").replace(i,"="+u+"$1"));n.url=n.url.replace(i,"="+u+"$1");window[u]=window[u]||function(i){data=i;h(n,f,t);c(n,f,t);window[u]=undefined;try{delete window[u]}catch(r){}head&&head.removeChild(script)}}function h(t,i,r){t.success&&t.success.call(i,r.responseText||"",status,{});t.global&&(t.context?n(t.context):n.event).trigger("ajaxSuccess",[{},t])}function c(t,i){t.complete&&t.complete.call(i,{},status);t.global&&(t.context?n(t.context):n.event).trigger("ajaxComplete",[{},t]);t.global&&!--n.active&&n.event.trigger("ajaxStop")}function g(i,e){var c,s,o,l,h;for(typeof i=="object"?(e=i,i=undefined):(e=e||{},e.url=i),s=n.extend(!0,{},n.ajaxSettings,e),l=function(t,i){var r=e[t.toLowerCase()];return function(){n.isFunction(r)&&r.apply(this,[].slice.call(arguments));i["onAfter"+t]()}},h=0;h<t.length;h++)if(t[h]&&(o=v(t[h],s),o))return(u.push(s),n.mockjaxSettings.log(o,s),s.dataType&&s.dataType.toUpperCase()==="JSONP"&&(c=w(s,o,e)))?c:(o.cache=s.cache,o.timeout=s.timeout,o.global=s.global,o.isTimeout&&(o.responseTime>1?e.timeout=o.responseTime-1:(o.responseTime=2,e.timeout=1),o.isTimeout=!1),n.isFunction(o.onAfterSuccess)&&(e.success=l("Success",o)),n.isFunction(o.onAfterError)&&(e.error=l("Error",o)),n.isFunction(o.onAfterComplete)&&(e.complete=l("Complete",o)),nt(o,e),function(t,i,u,f){c=r.call(n,n.extend(!0,{},u,{xhr:function(){return p(t,i,u,f)}}))}(o,s,e,t[h]),c);if(f.push(e),n.mockjaxSettings.throwUnmocked===!0)throw new Error("AJAX not mocked: "+e.url);else return r.apply(n,[e])}function nt(n,t){var i,f;if(n.url instanceof RegExp&&n.hasOwnProperty("urlParams")&&(i=n.url.exec(t.url),i.length!==1)){i.shift();var r=0,e=i.length,o=n.urlParams.length,s=Math.min(e,o),u={};for(r;r<s;r++)f=n.urlParams[r],u[f]=i[r];t.urlParams=u}}var r=n.ajax,t=[],u=[],f=[],i=/=\?(&|$)/,l=(new Date).getTime();n.extend({ajax:g});n.mockjaxSettings={log:function(t,i){if(t.logging!==!1&&(typeof t.logging!="undefined"||n.mockjaxSettings.logging!==!1)&&window.console&&console.log){var r="MOCK "+i.type.toUpperCase()+": "+i.url,u=n.extend({},i);if(typeof console.log=="function")console.log(r,u);else try{console.log(r+" "+JSON.stringify(u))}catch(f){console.log(r)}}},logging:!0,status:200,statusText:"OK",responseTime:500,isTimeout:!1,throwUnmocked:!1,contentType:"text/plain",response:"",responseText:"",responseXML:"",proxy:"",proxyType:"GET",lastModified:null,etag:"",headers:{etag:"IJF@H#@923uf8023hFO@I#H#","content-type":"text/plain"}};n.mockjax=function(n){var i=t.length;return t[i]=n,i};n.mockjax.clear=function(n){arguments.length==1?t[n]=null:t=[];u=[];f=[]};n.mockjaxClear=function(){window.console&&window.console.warn&&window.console.warn("DEPRECATED: The $.mockjaxClear() method has been deprecated in 1.6.0. Please use $.mockjax.clear() as the older function will be removed soon!");n.mockjax.clear()};n.mockjax.handler=function(n){if(arguments.length==1)return t[n]};n.mockjax.mockedAjaxCalls=function(){return u};n.mockjax.unfiredHandlers=function(){for(var n,r=[],i=0,u=t.length;i<u;i++)n=t[i],n===null||n.fired||r.push(n);return r};n.mockjax.unmockedAjaxCalls=function(){return f}})(jQuery);